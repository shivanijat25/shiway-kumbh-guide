<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Shahi Snan – Shiway</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="style.css">
<style>
/* Timeline specific styles */
.timeline {
    position: relative;
    padding: 20px 0;
}

.timeline::before {
    content: '';
    position: absolute;
    left: 50%;
    top: 0;
    bottom: 0;
    width: 4px;
    background: linear-gradient(to bottom, var(--primary-color), var(--secondary-color));
    transform: translateX(-50%);
}

.timeline-item {
    position: relative;
    margin-bottom: 50px;
    width: 100%;
}

.timeline-item:nth-child(odd) .timeline-content {
    margin-left: 0;
    margin-right: 55%;
    text-align: right;
}

.timeline-item:nth-child(even) .timeline-content {
    margin-left: 55%;
    margin-right: 0;
    text-align: left;
}

.timeline-marker {
    position: absolute;
    left: 50%;
    top: 20px;
    width: 20px;
    height: 20px;
    background: var(--primary-color);
    border: 4px solid white;
    border-radius: 50%;
    transform: translateX(-50%);
    z-index: 2;
    box-shadow: 0 0 0 4px rgba(255, 107, 53, 0.2);
}

.timeline-marker.active {
    background: var(--success-color);
    animation: pulse 2s infinite;
}

.timeline-marker.completed {
    background: var(--dark-color);
}

.timeline-content {
    background: white;
    padding: 25px;
    border-radius: var(--border-radius);
    box-shadow: var(--shadow-medium);
    transition: var(--transition);
    position: relative;
}

.timeline-content:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-heavy);
}

.timeline-content::before {
    content: '';
    position: absolute;
    top: 25px;
    width: 0;
    height: 0;
    border: 15px solid transparent;
}

.timeline-item:nth-child(odd) .timeline-content::before {
    right: -30px;
    border-left-color: white;
}

.timeline-item:nth-child(even) .timeline-content::before {
    left: -30px;
    border-right-color: white;
}

.countdown-timer {
    background: var(--gradient-primary);
    color: white;
    padding: 15px;
    border-radius: 10px;
    text-align: center;
    margin-top: 15px;
}

.countdown-numbers {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-top: 10px;
}

.countdown-unit {
    text-align: center;
}

.countdown-value {
    font-size: 2rem;
    font-weight: 700;
    display: block;
}

.countdown-label {
    font-size: 0.8rem;
    opacity: 0.9;
}

@media (max-width: 768px) {
    .timeline::before {
        left: 30px;
    }

    .timeline-marker {
        left: 30px;
    }

    .timeline-item:nth-child(odd) .timeline-content,
    .timeline-item:nth-child(even) .timeline-content {
        margin-left: 70px;
        margin-right: 0;
        text-align: left;
    }

    .timeline-content::before {
        left: -30px !important;
        right: auto !important;
        border-right-color: white !important;
        border-left-color: transparent !important;
    }
}
</style>
</head>
<body>

<!-- Navigation Bar -->
<nav class="navbar navbar-expand-lg navbar-dark fixed-top">
    <div class="container">
        <a class="navbar-brand d-flex align-items-center" href="index.html">
            <img src="assets/logo.png" alt="Shiway Logo" height="40" class="me-2" />
            <span class="fw-bold">SHIWAY</span>
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto">
                <li class="nav-item">
                    <a class="nav-link" href="index.html"><i class="fas fa-home me-1"></i>Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="shahi-snan.html"><i class="fas fa-calendar-alt me-1"></i>Shahi Snan</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="map.html"><i class="fas fa-map me-1"></i>Map</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="emergency.html"><i class="fas fa-phone-alt me-1"></i>Emergency</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<!-- Page Hero -->
<div class="page-hero">
    <div class="container">
        <img src="assets/logo.png" alt="Shiway Logo" />
        <h1><i class="fas fa-calendar-alt me-3"></i>Shahi Snan Schedule</h1>
        <p>Sacred bathing ceremonies and auspicious timings for the holy dip</p>

        <!-- Next Event Countdown -->
        <div class="row mt-4 justify-content-center">
            <div class="col-md-8">
                <div class="card glass-effect border-0">
                    <div class="card-body text-center text-white">
                        <h5 class="mb-3"><i class="fas fa-clock me-2"></i>Next Shahi Snan</h5>
                        <div id="nextEventCountdown">
                            <div class="countdown-numbers">
                                <div class="countdown-unit">
                                    <span class="countdown-value" id="days">00</span>
                                    <span class="countdown-label">Days</span>
                                </div>
                                <div class="countdown-unit">
                                    <span class="countdown-value" id="hours">00</span>
                                    <span class="countdown-label">Hours</span>
                                </div>
                                <div class="countdown-unit">
                                    <span class="countdown-value" id="minutes">00</span>
                                    <span class="countdown-label">Minutes</span>
                                </div>
                                <div class="countdown-unit">
                                    <span class="countdown-value" id="seconds">00</span>
                                    <span class="countdown-label">Seconds</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Main Content -->
<div class="container mt-5 mb-5">
    <!-- Page Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="text-center">
                <h2 class="text-gradient mb-2">Sacred Bathing Schedule</h2>
                <p class="text-muted">Complete timeline of all Shahi Snan ceremonies</p>
            </div>
        </div>
    </div>

    <!-- Timeline View -->
    <div class="row">
        <div class="col-12">
            <div class="timeline" id="shahiSnanTimeline">
                <!-- Timeline items will be populated by JavaScript -->
                <div class="text-center py-5">
                    <div class="loading-spinner mb-3"></div>
                    <p class="text-muted">Loading sacred schedule...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="row mt-5">
        <div class="col-12">
            <div class="card border-0 shadow-sm">
                <div class="card-body">
                    <h5 class="card-title text-center mb-4">
                        <i class="fas fa-hands-helping me-2 text-primary"></i>Helpful Resources
                    </h5>
                    <div class="row g-3">
                        <div class="col-md-3">
                            <a href="map.html" class="btn btn-outline-primary w-100">
                                <i class="fas fa-map-marked-alt me-2"></i>View Ghat Locations
                            </a>
                        </div>
                        <div class="col-md-3">
                            <button class="btn btn-outline-success w-100" onclick="setReminders()">
                                <i class="fas fa-bell me-2"></i>Set Reminders
                            </button>
                        </div>
                        <div class="col-md-3">
                            <a href="food-stations.html" class="btn btn-outline-warning w-100">
                                <i class="fas fa-utensils me-2"></i>Nearby Food
                            </a>
                        </div>
                        <div class="col-md-3">
                            <button class="btn btn-outline-info w-100" onclick="shareSchedule()">
                                <i class="fas fa-share me-2"></i>Share Schedule
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Important Information -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="alert alert-info border-0 shadow-sm">
                <h6 class="alert-heading">
                    <i class="fas fa-info-circle me-2"></i>Important Information
                </h6>
                <ul class="mb-0">
                    <li>Arrive at least 1 hour before the scheduled time</li>
                    <li>Follow all safety guidelines and instructions from authorities</li>
                    <li>Keep emergency contacts handy</li>
                    <li>Stay hydrated and carry necessary medications</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<!-- Footer -->
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-lg-4">
                <div class="footer-brand">
                    <img src="assets/logo.png" alt="Shiway Logo" height="40" />
                    <h5>SHIWAY</h5>
                    <p>Your trusted companion for Simhastha Kumbh Mela</p>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="footer-links">
                    <h6>Quick Links</h6>
                    <ul>
                        <li><a href="shahi-snan.html">Shahi Snan</a></li>
                        <li><a href="food-stations.html">Food Facilities</a></li>
                        <li><a href="map.html">Interactive Map</a></li>
                        <li><a href="emergency.html">Emergency Help</a></li>
                    </ul>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="footer-contact">
                    <h6>Emergency Contact</h6>
                    <p><i class="fas fa-phone"></i> +91-9999999999</p>
                    <p><i class="fas fa-envelope"></i> help@shiway.com</p>
                    <div class="social-links">
                        <a href="#"><i class="fab fa-facebook"></i></a>
                        <a href="#"><i class="fab fa-twitter"></i></a>
                        <a href="#"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2028 Shiway Project – Smart Simhastha Guide. Made with ❤️ for pilgrims.</p>
        </div>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="data.js"></script>
<script src="script.js"></script>

<script>
// Enhanced Shahi Snan functionality
document.addEventListener('DOMContentLoaded', () => {
    populateShahiSnanTimeline();
    startCountdown();
});

function populateShahiSnanTimeline() {
    const timeline = document.getElementById('shahiSnanTimeline');
    timeline.innerHTML = '';

    data.shahiSnan.forEach((item, index) => {
        const eventDate = new Date(`${item.date} ${item.time.split(' - ')[0]}`);
        const now = new Date();

        let markerClass = '';
        let statusText = '';
        let statusClass = '';

        if (eventDate < now) {
            markerClass = 'completed';
            statusText = 'Completed';
            statusClass = 'bg-secondary';
        } else if (index === 0) {
            markerClass = 'active';
            statusText = 'Next Event';
            statusClass = 'bg-success';
        } else {
            statusText = 'Upcoming';
            statusClass = 'bg-primary';
        }

        const timeUntil = getTimeUntilEvent(item.date, item.time);

        const timelineItem = document.createElement('div');
        timelineItem.className = 'timeline-item fade-in-up';
        timelineItem.style.animationDelay = `${index * 0.2}s`;

        timelineItem.innerHTML = `
            <div class="timeline-marker ${markerClass}"></div>
            <div class="timeline-content">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <h5 class="mb-0">${item.name}</h5>
                    <span class="badge ${statusClass}">${statusText}</span>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <p class="mb-2">
                            <i class="fas fa-map-marker-alt me-2 text-primary"></i>
                            <strong>Location:</strong> ${item.address}
                        </p>
                        <p class="mb-2">
                            <i class="fas fa-calendar me-2 text-primary"></i>
                            <strong>Date:</strong> ${item.date}
                        </p>
                        <p class="mb-0">
                            <i class="fas fa-clock me-2 text-primary"></i>
                            <strong>Time:</strong> ${item.time}
                        </p>
                    </div>
                    <div class="col-md-6">
                        ${timeUntil ? `
                            <div class="countdown-timer">
                                <small>Starts in</small>
                                <div class="fw-bold">${timeUntil}</div>
                            </div>
                        ` : ''}
                        <div class="mt-3">
                            <button class="btn btn-sm btn-outline-primary me-2"
                                    onclick="showOnMap(${item.lat}, ${item.lng}, '${item.name}')">
                                <i class="fas fa-map me-1"></i>View Location
                            </button>
                            <button class="btn btn-sm btn-outline-success"
                                    onclick="shareEvent('${item.name}', '${item.date}', '${item.time}')">
                                <i class="fas fa-share me-1"></i>Share
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        `;

        timeline.appendChild(timelineItem);
    });
}

function startCountdown() {
    const nextEvent = data.shahiSnan.find(event => {
        const eventDate = new Date(`${event.date} ${event.time.split(' - ')[0]}`);
        return eventDate > new Date();
    });

    if (!nextEvent) return;

    const targetDate = new Date(`${nextEvent.date} ${nextEvent.time.split(' - ')[0]}`);

    function updateCountdown() {
        const now = new Date();
        const diff = targetDate - now;

        if (diff <= 0) {
            document.getElementById('nextEventCountdown').innerHTML =
                '<div class="text-center"><h5>Event is Live Now!</h5></div>';
            return;
        }

        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((diff % (1000 * 60)) / 1000);

        document.getElementById('days').textContent = days.toString().padStart(2, '0');
        document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
        document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
        document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');
    }

    updateCountdown();
    setInterval(updateCountdown, 1000);
}

function setReminders() {
    if ('Notification' in window) {
        Notification.requestPermission().then(permission => {
            if (permission === 'granted') {
                showNotification('Reminders enabled! You will be notified before each Shahi Snan.', 'success');
                // In a real app, you would set up actual notifications
            } else {
                showNotification('Please enable notifications to receive reminders.', 'warning');
            }
        });
    } else {
        showNotification('Notifications not supported in this browser.', 'warning');
    }
}

function shareSchedule() {
    const scheduleText = data.shahiSnan.map(event =>
        `${event.name}\n📅 ${event.date}\n⏰ ${event.time}\n📍 ${event.address}\n`
    ).join('\n');

    if (navigator.share) {
        navigator.share({
            title: 'Shahi Snan Schedule - Shiway',
            text: 'Sacred bathing schedule for Simhastha Kumbh Mela:\n\n' + scheduleText
        });
    } else {
        navigator.clipboard.writeText(scheduleText).then(() => {
            showNotification('Schedule copied to clipboard!');
        });
    }
}

function shareEvent(name, date, time) {
    const eventText = `${name}\n📅 ${date}\n⏰ ${time}`;

    if (navigator.share) {
        navigator.share({
            title: `${name} - Shiway`,
            text: eventText
        });
    } else {
        navigator.clipboard.writeText(eventText).then(() => {
            showNotification('Event details copied to clipboard!');
        });
    }
}
</script>
</body>
</html>
